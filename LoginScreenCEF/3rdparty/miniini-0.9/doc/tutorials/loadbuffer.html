<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.sf.net">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="../docstyle.css">
<TITLE>Loading ini data from memory</TITLE>
</HEAD>
<BODY>

<DIV CLASS="header" ID="header">
<H1>Loading ini data from memory</H1>
</DIV>

<DIV CLASS="body" ID="body">
<P>
It can be useful to load data from memory instead of a file, e.g. if you store 
INI files in a compressed file and read them yourself. 
</P>
<H2>LoadBuffer</H2>
<P>
MiniINI allows loading INI data from memory using the <I><A HREF="../html/classINIFile.html#a820a07765946cb654f9c51d6830e5cb8">LoadBuffer</A></I> method
of <I>INIFile</I>. This tutorial explains how to read a simple INI file to memory
and parse it using <I>LoadBuffer</I>. You can find example code in 
<B>example/LoadBuffer</B> directory in the MiniINI package.
</P>
<H3>The code</H3>
<P>
Create a file called <B>example.ini</B> in your project directory, with these 
contents:
</P>
<PRE>
[section]
answer=42
</PRE>
<P></P>
<P>
First, we include what we need and start the <I>main</I> function.
</P>
<PRE>
#include&lt;miniini.h&gt;
#include&lt;iostream&gt;
#include&lt;fstream&gt;

int main()
{
</PRE>
<P></P>
<P>
Then we load the file from memory. (Static array is used for the sake of
simplicity. In real use, you'd determine file size and allocate enough space 
dynamically.) In order for <I>LoadBuffer</I> to work properly, you <B>must</B> add a 
trailing zero to the end of the buffer. Also, you can only call <I>LoadBuffer</I> 
on an <I>INIFile</I> that has not yet been loaded (using <I>OpenFile</I> or 
<I>LoadBuffer</I>).
</P>
<PRE>
    char buf[64];
    std::ifstream fin( "example.ini" );
    fin.read(buf, 63);
    if(fin.bad())
        std::cout &lt;&lt; "ERROR: Could not read from example.ini";
    buf[63] = '\0';
</PRE>
<P></P>
<P>
Now we create an <I>INIFile</I> and use <I>LoadBuffer</I> to initialize it. 
<I>LoadBuffer</I> takes two arguments: buffer to read from and size of that buffer
(including the trailing zero). It returns <U>true</U> if the buffer was 
successfully loaded, <U>false</U> otherwise.
</P>
<PRE>
    INIFile ini;
    if(!ini.LoadBuffer(buf, 64))
        std::cout &lt;&lt; "ERROR: error in parsing ini file data";
</PRE>
<P></P>
<P>
Finally, we read and print data from the <I>INIFile</I> to test if everything works
correctly, and end the <I>main</I> function.
</P>
<PRE>
    INISection * section = ini.GetSection("section");
    if(!section)
        std::cout &lt;&lt; "ERROR: Missing section [section]" &lt;&lt; std::endl;
    int answer;
    if(!section-&gt;ReadInt("answer", answer))
        std::cout &lt;&lt; "ERROR: Missing tag answer=" &lt;&lt; std::endl;
    std::cout &lt;&lt; "The answer is " &lt;&lt; answer;
    return 0;
}
</PRE>
<P></P>
<HR NOSHADE SIZE=1>
<P></P>
<P>
<B>Last update: 07-07-2010</B>
</P>
</DIV>

<!-- html code generated by txt2tags 2.5 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags -t html -v -\-encoding utf-8 -\-css-sugar -\-style ../docstyle.css ./doc/tutorials/loadbuffer.txt -->
</BODY></HTML>
